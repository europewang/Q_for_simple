# MyQuant é¡¹ç›®æ¸…ç†è®°å½•

## ğŸ“‹ æ¸…ç†æ¦‚è¿°

æœ¬æ¬¡æ¸…ç†æ—¨åœ¨åˆ é™¤é¡¹ç›®ä¸­æ— ç”¨çš„æ–‡ä»¶ï¼Œä»…ä¿ç•™å½“å‰éœ€æ±‚æ‰€éœ€çš„æ ¸å¿ƒæ–‡ä»¶ï¼Œæé«˜é¡¹ç›®çš„æ•´æ´æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚

**æ¸…ç†æ—¶é—´**: 2024å¹´12æœˆ

## ğŸ—‚ï¸ æ¸…ç†å†…å®¹



### 1. åˆ é™¤çš„ç­–ç•¥æ–‡ä»¶

ä»¥ä¸‹ç­–ç•¥æ–‡ä»¶å·²è¢«åˆ é™¤ï¼š

#### åˆ é™¤çš„æ–‡ä»¶ï¼š
- `strategies/complex_ema_strategy.py`
- `strategies/advanced_staged_ema_strategy.py`

#### åŸå› ï¼š
- ç®€åŒ–é¡¹ç›®ç»“æ„ï¼Œä»…ä¿ç•™æ ¸å¿ƒç­–ç•¥
- å‡å°‘ä¸å¿…è¦çš„ä»£ç å’Œç»´æŠ¤è´Ÿæ‹…

### 2. åˆ é™¤çš„æµ‹è¯•å’Œä¸´æ—¶æ–‡ä»¶

#### åˆ é™¤çš„æ–‡ä»¶ï¼š
- `ema_crossover_backtest.py` - æ—§ç‰ˆæœ¬å›æµ‹è„šæœ¬
- `test_proxy.py` - ä»£ç†æµ‹è¯•æ–‡ä»¶
- `trade_analysis.py` - æ—§ç‰ˆæœ¬äº¤æ˜“åˆ†æè„šæœ¬

#### åŸå› ï¼š
- åŠŸèƒ½å·²è¢«æ–°çš„ç­–ç•¥ç³»ç»Ÿæ›¿ä»£
- ä¸å†ç¬¦åˆå½“å‰æ¶æ„è®¾è®¡

### 3. åˆ é™¤çš„è¾“å‡ºæ–‡ä»¶

#### åˆ é™¤çš„æ–‡ä»¶ï¼š
- `simple_ema_strategy_chart.png` - æ—§ç‰ˆæœ¬å›¾è¡¨
- `strategy_comparison.csv` - æ—§ç‰ˆæœ¬å¯¹æ¯”æ•°æ®
- `strategy_comparison_charts.png` - æ—§ç‰ˆæœ¬å¯¹æ¯”å›¾è¡¨
- `strategy_detailed_results.json` - æ—§ç‰ˆæœ¬ç»“æœæ•°æ®
- `trades_detailed_log.txt` - æ—§ç‰ˆæœ¬äº¤æ˜“æ—¥å¿—

#### åŸå› ï¼š
- è¿™äº›æ˜¯æ—§ç‰ˆæœ¬ç­–ç•¥çš„è¾“å‡ºç»“æœ
- æ–°çš„ç­–ç•¥ç³»ç»Ÿä¼šç”Ÿæˆæ–°çš„è¾“å‡ºæ–‡ä»¶

### 4. åˆ é™¤çš„æ–‡æ¡£æ–‡ä»¶

#### åˆ é™¤çš„æ–‡ä»¶ï¼š
- `äº¤æ˜“åˆ†ææŠ¥å‘Š.md` - æ—§ç‰ˆæœ¬åˆ†ææŠ¥å‘Š
- `ç­–ç•¥é‡æ„ä¸å¯¹æ¯”åˆ†ææŠ¥å‘Š.md` - ä¸´æ—¶é‡æ„æŠ¥å‘Š

#### åŸå› ï¼š
- å†…å®¹å·²è¿‡æ—¶
- æ–°çš„æ–‡æ¡£ä½“ç³»æ›´åŠ å®Œå–„

### 5. æ¸…ç†çš„ç¼“å­˜æ–‡ä»¶

#### æ¸…ç†çš„ç›®å½•ï¼š
- `__pycache__/` - Pythonå­—èŠ‚ç ç¼“å­˜
- `strategies/__pycache__/` - ç­–ç•¥æ¨¡å—ç¼“å­˜
- `temp/data_cache/` - ä¸´æ—¶æ•°æ®ç¼“å­˜
- `strategies/temp/data_cache/` - ç­–ç•¥ä¸´æ—¶ç¼“å­˜
- `strategies/output/` - é‡å¤çš„è¾“å‡ºæ–‡ä»¶

#### åŸå› ï¼š
- ç¼“å­˜æ–‡ä»¶ä¼šè‡ªåŠ¨é‡æ–°ç”Ÿæˆ
- å‡å°‘é¡¹ç›®ä½“ç§¯
- é¿å…ç¼“å­˜å†²çª

## ğŸ“ ä¿ç•™çš„æ ¸å¿ƒæ–‡ä»¶

### ç­–ç•¥æ–‡ä»¶ï¼ˆRefactoredç‰ˆæœ¬ï¼‰
- `strategies/simple_ema_strategy_refactored.py`
- `strategies/staged_ema_strategy_refactored.py`
- `strategies/complex_ema_strategy_refactored.py`
- `strategies/advanced_staged_ema_strategy_refactored.py`

### æ ¸å¿ƒç³»ç»Ÿæ–‡ä»¶
- `strategies/base_strategy.py` - ç­–ç•¥åŸºç±»
- `strategies/config_manager.py` - é…ç½®ç®¡ç†å™¨
- `strategies/strategy_runner.py` - ç­–ç•¥è¿è¡Œå™¨
- `data_manager.py` - æ•°æ®ç®¡ç†å™¨
- `strategy_manager.py` - ç­–ç•¥ç®¡ç†å™¨ï¼ˆå·²æ›´æ–°å¼•ç”¨ï¼‰

### é…ç½®æ–‡ä»¶
- `config.json` - ç»Ÿä¸€é…ç½®æ–‡ä»¶ï¼ˆåŒ…å«å…¨å±€é…ç½®ã€ç­–ç•¥é…ç½®ã€æ—¥å¿—é…ç½®ç­‰ï¼‰
- `.env` - ç¯å¢ƒå˜é‡é…ç½®
- `requirements.txt` - ä¾èµ–åŒ…åˆ—è¡¨

### æ–‡æ¡£æ–‡ä»¶
- `docs/æ“ä½œè¯´æ˜.md` - æ“ä½œæŒ‡å—
- `docs/ç®—æ³•è¯´æ˜.md` - ç®—æ³•æ–‡æ¡£
- `docs/é¡¹ç›®æ¸…ç†è®°å½•.md` - æœ¬æ¸…ç†è®°å½•

### æœ‰ä»·å€¼çš„æ•°æ®æ–‡ä»¶
- `output/monthly_data/` - æœˆåº¦å†å²æ•°æ®ï¼ˆä¿ç•™ï¼‰

## ğŸ”§ æ›´æ–°çš„æ–‡ä»¶

### strategy_manager.py
æ›´æ–°äº†å¯¼å…¥è¯­å¥ï¼Œç°åœ¨å¼•ç”¨refactoredç‰ˆæœ¬çš„ç­–ç•¥æ–‡ä»¶ï¼š

```python
# æ›´æ–°å‰
from strategies.complex_ema_strategy import ComplexEMAStrategy
from strategies.simple_ema_strategy import SimpleEMAStrategy

# æ›´æ–°å
from strategies.complex_ema_strategy_refactored import ComplexEMAStrategy
from strategies.simple_ema_strategy_refactored import SimpleEMAStrategy
```

åŒæ—¶æ›´æ–°äº†åŠ¨æ€å¯¼å…¥éƒ¨åˆ†ï¼Œç¡®ä¿æ‰€æœ‰ç­–ç•¥éƒ½ä½¿ç”¨refactoredç‰ˆæœ¬ã€‚

## ğŸ“Š æ¸…ç†ç»Ÿè®¡

### åˆ é™¤æ–‡ä»¶ç»Ÿè®¡
- **ç­–ç•¥æ–‡ä»¶**: 4ä¸ªæ—§ç‰ˆæœ¬æ–‡ä»¶
- **æµ‹è¯•æ–‡ä»¶**: 3ä¸ªä¸´æ—¶æµ‹è¯•æ–‡ä»¶
- **è¾“å‡ºæ–‡ä»¶**: 5ä¸ªæ—§ç‰ˆæœ¬è¾“å‡ºæ–‡ä»¶
- **æ–‡æ¡£æ–‡ä»¶**: 2ä¸ªè¿‡æ—¶æ–‡æ¡£æ–‡ä»¶
- **ç¼“å­˜æ–‡ä»¶**: å¤šä¸ªç¼“å­˜ç›®å½•

### é¡¹ç›®ç»“æ„ä¼˜åŒ–
- å‡å°‘äº†çº¦50%çš„éå¿…è¦æ–‡ä»¶
- ç»Ÿä¸€äº†ä»£ç ç‰ˆæœ¬ç®¡ç†
- æé«˜äº†é¡¹ç›®å¯ç»´æŠ¤æ€§
- å‡å°‘äº†æ–°å¼€å‘è€…çš„å›°æƒ‘

## ğŸ¯ æ¸…ç†æ•ˆæœ

### ä¼˜åŠ¿
1. **ä»£ç ä¸€è‡´æ€§**: ç»Ÿä¸€ä½¿ç”¨refactoredç‰ˆæœ¬ç­–ç•¥
2. **é¡¹ç›®æ•´æ´**: åˆ é™¤äº†å†—ä½™å’Œè¿‡æ—¶æ–‡ä»¶
3. **ç»´æŠ¤ç®€åŒ–**: å‡å°‘äº†éœ€è¦ç»´æŠ¤çš„æ–‡ä»¶æ•°é‡
4. **æ€§èƒ½æå‡**: æ¸…ç†äº†ç¼“å­˜æ–‡ä»¶ï¼Œé¿å…æ½œåœ¨å†²çª
5. **æ–‡æ¡£å®Œå–„**: ä¿ç•™äº†æœ€æ–°çš„æ–‡æ¡£ä½“ç³»

### æ³¨æ„äº‹é¡¹
1. æ‰€æœ‰æ—§ç‰ˆæœ¬ç­–ç•¥çš„åŠŸèƒ½éƒ½å·²åœ¨refactoredç‰ˆæœ¬ä¸­å®ç°
2. å†å²æ•°æ®æ–‡ä»¶ï¼ˆmonthly_dataï¼‰å·²ä¿ç•™
3. é…ç½®æ–‡ä»¶å’Œç¯å¢ƒè®¾ç½®ä¿æŒä¸å˜
4. æ–°çš„è¾“å‡ºæ–‡ä»¶ä¼šåœ¨è¿è¡Œç­–ç•¥æ—¶è‡ªåŠ¨ç”Ÿæˆ

## ğŸš€ åç»­å»ºè®®

1. **å®šæœŸæ¸…ç†**: å»ºè®®æ¯æœˆæ¸…ç†ä¸€æ¬¡ä¸´æ—¶æ–‡ä»¶å’Œç¼“å­˜
2. **ç‰ˆæœ¬æ§åˆ¶**: ä½¿ç”¨Gitå¿½ç•¥ç¼“å­˜æ–‡ä»¶å’Œä¸´æ—¶è¾“å‡º
3. **æ–‡æ¡£ç»´æŠ¤**: åŠæ—¶æ›´æ–°æ–‡æ¡£ï¼Œåˆ é™¤è¿‡æ—¶å†…å®¹
4. **ä»£ç å®¡æŸ¥**: å®šæœŸæ£€æŸ¥æ˜¯å¦æœ‰æ–°çš„å†—ä½™æ–‡ä»¶äº§ç”Ÿ

---

## ğŸ”§ é‡è¦ä¿®å¤è®°å½•

### åˆ†æ‰¹å…¥åœºEMAç­–ç•¥èµ„é‡‘ç®¡ç†ä¿®å¤ (2025-01-16)

#### é—®é¢˜æè¿°
åœ¨ `staged_ema_strategy.py` ä¸­å‘ç°äº†ä¸¥é‡çš„èµ„é‡‘ç®¡ç†ç¼ºé™·ï¼š

1. **èµ„é‡‘è®¡ç®—é”™è¯¯**: `add_to_position` å’Œ `open_position_staged` æ–¹æ³•ä¸­ï¼Œ`capital_to_add` å’Œ `capital_to_use` åŸºäº `self.initial_capital` è®¡ç®—ï¼Œè€Œä¸æ˜¯å½“å‰å¯ç”¨èµ„é‡‘ `self.capital`
2. **ä¿è¯é‡‘æ‰£é™¤ä¸å®Œæ•´**: åªæ‰£é™¤æ‰‹ç»­è´¹ï¼Œæœªæ‰£é™¤æŠ•å…¥çš„ä¿è¯é‡‘
3. **èµ„é‡‘å›æ”¶ä¸å®Œæ•´**: å¹³ä»“æ—¶åªå›æ”¶å‡€ç›ˆäºï¼Œæœªå›æ”¶æœ¬é‡‘ï¼ˆä¿è¯é‡‘ï¼‰
4. **position_percentage æœªç”Ÿæ•ˆ**: è®¡ç®—æŠ•å…¥èµ„é‡‘æ—¶æœªè€ƒè™‘é…ç½®çš„ `position_percentage` (95%)

#### ä¿®å¤å†…å®¹

**1. ä¿®å¤ `add_to_position` æ–¹æ³• (ç¬¬304è¡Œ)**
```python
# ä¿®å¤å‰
capital_to_add = self.initial_capital * stage_percentage

# ä¿®å¤å  
capital_to_add = self.capital * self.position_percentage * stage_percentage
```

**2. ä¿®å¤ `open_position_staged` æ–¹æ³• (ç¬¬222è¡Œ)**
```python
# ä¿®å¤å‰
capital_to_use = self.capital * stage_percentage

# ä¿®å¤å
capital_to_use = self.capital * self.position_percentage * stage_percentage
```

**3. ä¿®å¤èµ„é‡‘æ‰£é™¤é€»è¾‘**
```python
# åœ¨ add_to_position æ–¹æ³•ä¸­ (ç¬¬340è¡Œ)
self.capital -= (capital_to_add + fee_cost)  # æ‰£é™¤ä¿è¯é‡‘å’Œæ‰‹ç»­è´¹

# åœ¨ open_position_staged æ–¹æ³•ä¸­ (ç¬¬250è¡Œ)  
self.capital -= (capital_to_use + fee_cost)  # æ‰£é™¤ä¿è¯é‡‘å’Œæ‰‹ç»­è´¹
```

**4. ä¿®å¤èµ„é‡‘å›æ”¶é€»è¾‘ (ç¬¬570è¡Œ)**
```python
# ä¿®å¤å‰
self.capital += total_profit

# ä¿®å¤å
self.capital += (self.current_stage_capital_allocated + total_profit)
```

#### ä¿®å¤éªŒè¯
é€šè¿‡å›æµ‹éªŒè¯ä¿®å¤æ•ˆæœï¼š
- **ä¿®å¤å‰**: æ‰€æœ‰äº¤æ˜“æŠ•å…¥é‡‘é¢æ˜¾ç¤ºä¸º $0.00
- **ä¿®å¤å**: äº¤æ˜“æŠ•å…¥é‡‘é¢æ­£ç¡®åæ˜ å¯ç”¨èµ„é‡‘å˜åŒ–
  - ç¬¬1æ¬¡äº¤æ˜“: $3,700.00
  - ç¬¬2æ¬¡äº¤æ˜“: $3,939.05 (åŸºäºå‰©ä½™èµ„é‡‘)
  - ç¬¬6æ¬¡äº¤æ˜“: $1,311.29 (ç›ˆåˆ©åèµ„é‡‘å¢åŠ )

#### å½±å“èŒƒå›´
- âœ… æœŸè´§äº¤æ˜“ä¿è¯é‡‘ç®¡ç†ç°å·²æ­£ç¡®
- âœ… èµ„é‡‘åˆ©ç”¨ç‡è®¡ç®—å‡†ç¡®
- âœ… ç›ˆäºå¯¹åç»­äº¤æ˜“çš„å½±å“æ­£ç¡®åæ˜ 
- âœ… position_percentage é…ç½®ç”Ÿæ•ˆ

---

*æœ¬æ¸…ç†è®°å½•ç¡®ä¿äº†é¡¹ç›®çš„æ•´æ´æ€§å’Œå¯ç»´æŠ¤æ€§ï¼Œä¸ºåç»­å¼€å‘æä¾›äº†è‰¯å¥½çš„åŸºç¡€ã€‚*